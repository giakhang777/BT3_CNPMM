<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>All Users</title>
  <style>
    body { font-family: sans-serif; margin: 24px; }
    nav a { margin-right: 12px; text-decoration: none; color: #06c; }
    h1 { margin: 12px 0 16px; }
    table { border-collapse: collapse; width: 100%; margin-top: 12px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #f4f4f4; }
    .container { max-width: 980px; margin: 0 auto; }
  </style>
</head>
<body>
  <div class="container">
    <nav>
      <a href="/home">Home</a>
      <a href="/crud">Create</a>
      <a href="/get-crud"><b>List Users</b></a>
    </nav>

    <h1>All Users</h1>

    <% const rows = Array.isArray(datalist) ? datalist : []; %>
    <% if (rows.length === 0) { %>
      <p>No users found. <a href="/crud">Create one?</a></p>
    <% } else { %>
      <table>
        <thead>
          <tr>
            <th>Email</th>
            <th>Name</th>
            <th>Phone</th>
            <th>Address</th>
            <th>Role</th>
            <th>Gender</th>
            <th style="width:160px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% rows.forEach(u => { const uid = u.id || u._id; %>
            <tr>
              <td><%= u.email %></td>
              <td><%= (u.firstName || '') + ' ' + (u.lastName || '') %></td>
              <td><%= u.phoneNumber || '' %></td>
              <td><%= u.address || '' %></td>
              <td><%= u.roleId || '' %></td>
              <td><%= u.gender ? 'Male' : 'Female' %></td>
              <td>
                <a href="/edit-crud?id=<%= uid %>">Edit</a> |
                <a href="/delete-crud?id=<%= uid %>" onclick="return confirm('Delete this user?')">Delete</a>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    <% } %>

    <p style="margin-top:12px;">
      <a href="/crud">+ Create new</a>
    </p>
  </div>
</body>
</html>
